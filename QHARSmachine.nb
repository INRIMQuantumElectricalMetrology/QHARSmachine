(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     93696,       1895]
NotebookOptionsPosition[     92217,       1852]
NotebookOutlinePosition[     92583,       1868]
CellTagsIndexPosition[     92540,       1865]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"QHARSmachine", ":", " ", 
     RowBox[{
     "Wolfram", " ", "Mathematica", " ", "notebook", " ", "for", " ", "the", 
      " ", "DC", " ", "analysis", " ", "of", " ", "quantum", " ", "Hall", " ",
       "array", " ", "resistance", " ", 
      RowBox[{"standards", ".", " ", "For"}], " ", "more", " ", 
      "information"}]}], ",", " ", 
    RowBox[{"see", ":", " ", 
     RowBox[{"Martina", " ", "Marzano"}]}], ",", 
    RowBox[{"Takehiko", " ", "Oe"}], ",", " ", 
    RowBox[{"Massimo", " ", "Ortolano"}], ",", " ", 
    RowBox[{"Luca", " ", "Callegaro"}], ",", " ", 
    RowBox[{
     RowBox[{"and", " ", "Nobu"}], "-", 
     RowBox[{"Hisa", " ", "Kaneko"}]}], ",", " ", 
    RowBox[{
     RowBox[{
     "\"\<Error modelling of Quantum Hall array resistance standards\>\"", 
      ".", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", "Copyright"}], 
     " ", 
     RowBox[{"(", "C", ")"}], "2017", "  ", "Martina", " ", "Marzano", " ", 
     RowBox[{"(", 
      RowBox[{"martina", ".", 
       RowBox[{"marzano", "@", "polito"}], ".", "it"}], ")"}]}], ",", " ", 
    RowBox[{"Massimo", " ", "Ortolano", " ", 
     RowBox[{"(", 
      RowBox[{"massimo", ".", 
       RowBox[{"ortolano", "@", "polito"}], ".", "it"}], ")"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "This", " ", "program", 
     " ", "is", " ", "free", " ", 
     RowBox[{"software", ":", 
      RowBox[{"you", " ", "can", " ", "redistribute", " ", "it", " ", 
       RowBox[{"and", "/", "or"}], " ", "modify", " ", "it", " ", "under", 
       " ", "the", " ", "terms", " ", "of", " ", "the", " ", "GNU", " ", 
       "General", " ", "Public", " ", "License", " ", "as", " ", "published", 
       " ", "by", " ", "the", " ", "Free", " ", "Software", " ", 
       "Foundation"}]}]}], ",", 
    RowBox[{
    "either", " ", "version", " ", "3", " ", "of", " ", "the", " ", 
     "License"}], ",", " ", 
    RowBox[{"or", 
     RowBox[{"(", 
      RowBox[{"at", " ", "your", " ", "option"}], ")"}], " ", "any", " ", 
     "later", " ", 
     RowBox[{
     "version", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", "This"}], 
     " ", "program", " ", "is", " ", "distributed", " ", "in", " ", "the", 
     " ", "hope", " ", "that", " ", "it", " ", "will", " ", "be", " ", 
     "useful"}], ",", " ", 
    RowBox[{
     RowBox[{"but", " ", "WITHOUT", " ", "ANY", " ", "WARRANTY"}], ";", 
     RowBox[{
     "without", " ", "even", " ", "the", " ", "implied", " ", "warranty", " ",
       "of", " ", "MERCHANTABILITY", " ", "or", " ", "FITNESS", " ", "FOR", 
      " ", "A", " ", "PARTICULAR", " ", 
      RowBox[{"PURPOSE", ".", " ", "See"}], " ", "the", " ", "GNU", " ", 
      "General", " ", "Public", " ", "License", " ", "for", " ", "more", " ", 
      RowBox[{"details", ".", " ", "You"}], " ", "should", " ", "have", " ", 
      "received", " ", "a", " ", "copy", " ", "of", " ", "the", " ", "GNU", 
      " ", "General", " ", "Public", " ", "License", " ", "along", " ", 
      "with", " ", "this", " ", 
      RowBox[{"program", ".", "If"}], " ", "not"}]}], ",", 
    RowBox[{
     RowBox[{"see", "<", 
      RowBox[{"http", ":"}]}], "//", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"www", ".", "gnu", ".", "org"}], "/", "licenses"}], "/"}], 
      ">", "."}]}]}], "\[IndentingNewLine]", "*)"}]}]], "Input",
 CellChangeTimes->{
  3.717909855838792*^9, {3.717910047008754*^9, 3.7179102519368153`*^9}, {
   3.717910314752997*^9, 3.717910381681031*^9}, {3.7179104729051027`*^9, 
   3.717910503833053*^9}, {3.71791058943183*^9, 3.717910647288927*^9}, 
   3.718425463740307*^9, {3.7184564674159393`*^9, 3.7184564682317867`*^9}},
 ExpressionUUID -> "98b26e2b-3c6f-4a71-8c17-aec7d93c8c72"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "file", ",", "n", ",", "m", ",", "l", ",", "\[ScriptCapitalA]", ",", 
     "\[ScriptCapitalA]T", ",", "rQn", ",", "a", ",", "b", ",", "c", ",", "d",
      ",", "s", ",", "wp", ",", "rightCirculantMatrix", ",", "qheCwIdeal", 
     ",", "qheCcwIdeal", ",", "takeOperator", ",", "complementaryIndices", 
     ",", "wp", ",", "\[ScriptCapitalY]i", ",", "rnSign", ",", "epsilonLim", 
     ",", "deltaLim", ",", "epsilon", ",", "delta", ",", "result", ",", 
     "\[ScriptCapitalD]", ",", "g", ",", "\[ScriptCapitalY]", ",", 
     "\[ScriptCapitalY]n", ",", "gn", ",", "\[Tau]", ",", "meanResult", ",", 
     "stdDevResult", ",", "h", ",", "qheType"}], "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "function", " ", "below", " ", "is", " ", "useful", " ", "for",
     " ", "the", " ", "following", " ", "definitions"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rightCirculantMatrix", "[", 
    RowBox[{"l_List", "?", "VectorQ"}], "]"}], ":=", 
   RowBox[{"NestList", "[", 
    RowBox[{"RotateRight", ",", 
     RowBox[{"RotateRight", "[", "l", "]"}], ",", 
     RowBox[{
      RowBox[{"Length", "[", "l", "]"}], "-", "1"}]}], "]"}]}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
   "These", " ", "operators", " ", "define", " ", "the", " ", "Yi", " ", 
    "IAM", " ", "matrices", " ", "of", " ", "an", " ", "ideal", " ", "QHE", 
    " ", "element", " ", 
    RowBox[{"(", 
     RowBox[{"clockwise", " ", "and", " ", "counterclockwise"}], ")"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"qheCwIdeal", "[", "x_Integer", "]"}], ":=", 
  RowBox[{
   RowBox[{"rightCirculantMatrix", "[", 
    RowBox[{"PadLeft", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "x"}], "]"}], "]"}], "/;", 
   RowBox[{"x", "\[GreaterEqual]", "2"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"qheCcwIdeal", "[", "x_Integer", "]"}], ":=", 
   RowBox[{
    RowBox[{"rightCirculantMatrix", "[", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"-", "1"}], "}"}], ",", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"x", "-", "2"}]}], "]"}], ",", 
       RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "/;", 
    RowBox[{"x", "\[GreaterEqual]", "2"}]}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "The", " ", "operators", " ", "below", " ", "are", " ", "taken", " ", 
     "from", " ", 
     RowBox[{"http", ":"}]}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"stackoverflow", ".", "com"}], "/", "a"}], "/", "5300892"}], 
     "/", "2522705"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"takeOperator", "[", 
   RowBox[{
    RowBox[{"w_", "?", "MatrixQ"}], ",", "rows_List", ",", "cols_List"}], 
   "]"}], ":=", 
  RowBox[{"w", "[", 
   RowBox[{"[", 
    RowBox[{"rows", ",", "cols"}], "]"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"dropOperator", "[", 
   RowBox[{
    RowBox[{"w_", "?", "MatrixQ"}], ",", "rows_List", ",", "cols_List"}], 
   "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"[", "##", "]"}], "]"}], "&"}], "@@", 
   RowBox[{"complementaryIndices", "[", 
    RowBox[{"w", ",", "rows", ",", "cols"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"complementaryIndices", "[", 
   RowBox[{
    RowBox[{"w_", "?", "MatrixQ"}], ",", "rows_List", ",", "cols_List"}], 
   "]"}], ":=", 
  RowBox[{"Complement", "@@@", 
   RowBox[{"Transpose", "@", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Range", "/@", 
       RowBox[{"Dimensions", "@", "w"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"rows", ",", "cols"}], "}"}]}], "}"}]}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.704626495389015*^9, 3.7046264965045633`*^9}, {
   3.704626554576091*^9, 3.704626582431898*^9}, {3.704626616814355*^9, 
   3.70462661787991*^9}, {3.704632875192752*^9, 3.7046328754278817`*^9}, {
   3.704693594422612*^9, 3.704693594612714*^9}, {3.7046960351586227`*^9, 
   3.7046960358585615`*^9}, {3.7046961753727055`*^9, 
   3.7046961766329937`*^9}, {3.7047074383887515`*^9, 3.704707507543435*^9}, {
   3.7047076031306624`*^9, 3.704707629379454*^9}, {3.7047093129712024`*^9, 
   3.704709341160091*^9}, {3.704709382646591*^9, 3.704709456793125*^9}, {
   3.7047100638988323`*^9, 3.704710066956418*^9}, {3.7047107689920225`*^9, 
   3.70471077506447*^9}, {3.704711975496564*^9, 3.704711979292144*^9}, 
   3.7047120306020603`*^9, {3.7047149975599756`*^9, 3.704715000154909*^9}, {
   3.704777948498602*^9, 3.7047779726182146`*^9}, {3.704778482613924*^9, 
   3.7047784865338697`*^9}, {3.718454479616493*^9, 3.7184544796957197`*^9}, {
   3.7187047452695036`*^9, 3.7187047469403954`*^9}, 3.7192275032410035`*^9, {
   3.719227712244935*^9, 3.7192278099172544`*^9}, {3.719227871893041*^9, 
   3.719227946392408*^9}, {3.7192304108511105`*^9, 3.7192304121274624`*^9}, 
   3.720160547776998*^9, {3.7201610827847424`*^9, 
   3.7201611250483627`*^9}},ExpressionUUID->"5d01b7c7-7ee1-4903-86e7-\
d078ce7e291f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"fileNetlist", "=", "\"\<\>\""}], ",", "\[IndentingNewLine]", 
      RowBox[{"qharsSchematic", "=", "\"\<\>\""}], ",", "\[IndentingNewLine]", 
      RowBox[{"qharsList", "=", "\"\<\>\""}], ",", "\[IndentingNewLine]", 
      RowBox[{"qharsNetlist", " ", "=", "\"\<\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"qheNodes", "=", 
       RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"resistorNodes", "=", 
       RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"qharsNodes", "=", 
       RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"rows", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Button", "[", 
     RowBox[{"\"\<Load QHARS Schematic\>\"", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"m", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"l", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[ScriptCapitalA]", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"rQn", "=", 
        RowBox[{"1", "/", "1"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"wp", "=", 
        RowBox[{"4", "MachinePrecision"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"s", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"a", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"b", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"c", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"d", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"file", "=", 
        RowBox[{"SystemDialogInput", "[", 
         RowBox[{"\"\<FileOpen\>\"", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"NotebookDirectory", "[", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\"\<LTspice schematic\>\"", "->", 
               RowBox[{"{", "\"\<*.asc\>\"", "}"}]}], ",", 
              RowBox[{"\"\<All files\>\"", "->", 
               RowBox[{"{", 
                StyleBox["\"\<*.*\>\"", "TR"], "}"}]}]}], "}"}]}], "}"}], ",", 
          RowBox[{
          "WindowTitle", "\[Rule]", "\"\<Choose the QHARS schematic\>\""}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"file", "=!=", "$Canceled"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"qharsSchematic", "=", 
           RowBox[{"Import", "[", 
            RowBox[{"file", ",", "\"\<Text\>\""}], "]"}]}], ";", " ", 
          RowBox[{"(*", 
           RowBox[{
           "The", " ", "program", " ", "imports", " ", "the", " ", "QHARS", 
            " ", 
            RowBox[{"schematic", "."}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
            "The", " ", "program", " ", "extracts", " ", "the", " ", 
             "parameters", " ", "a"}], ",", 
            RowBox[{"b", " ", 
             RowBox[{"(", 
              RowBox[{"volage", " ", "nodes"}], ")"}], " ", "and", " ", "c"}],
             ",", 
            RowBox[{"d", " ", 
             RowBox[{"(", 
              RowBox[{"current", " ", "nodes"}], ")"}]}], ",", " ", 
            RowBox[{"and", " ", 
             RowBox[{"p", "/", "q"}], " ", 
             RowBox[{"(", 
              RowBox[{
              "nominal", " ", "resistance", " ", "value", " ", "normalized", 
               " ", "to", " ", "RH"}], ")"}], " ", "from", " ", "the", " ", 
             RowBox[{"schematic", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"ToExpression", "[", 
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"StringCases", "[", 
              RowBox[{"qharsSchematic", ",", 
               RowBox[{
               "RegularExpression", "[", 
                "\"\<p/q\\\\s*=.+|a\\\\s*=.+|b\\\\s*=.+|c\\\\s*=.+|d\\\\s*=.+\
\>\"", "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<p/q\>\"", "\[Rule]", "\"\<rQn\>\""}], "}"}]}], 
            "]"}], "]"}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "The", " ", "program", " ", "runs", " ", "LTspice", " ", "XVIIx64",
             " ", 
            RowBox[{"(", 
             RowBox[{
             "in", " ", "both", " ", "Windows", " ", "or", " ", "Unix", " ", 
              "OS"}], ")"}], " ", "and", " ", "imports", " ", "the", " ", 
            "LTspice", " ", 
            RowBox[{"netlist", "."}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"Switch", "[", 
           RowBox[{"$OperatingSystem", ",", "\"\<Windows\>\"", ",", 
            RowBox[{"RunProcess", "[", 
             RowBox[{"{", 
              RowBox[{
              "\"\<XVIIx64.exe\>\"", ",", "\"\<-netlist\>\"", ",", "file"}], 
              "}"}], "]"}], ",", "\"\<Unix\>\"", ",", 
            RowBox[{"RunProcess", "[", 
             RowBox[{"{", 
              RowBox[{
              "\"\<wine\>\"", ",", "\"\<XVIIx64.exe\>\"", ",", 
               "\"\<-netlist\>\"", ",", " ", 
               RowBox[{
                RowBox[{"TemplateApply", "[", 
                 RowBox[{"\"\<`StandardOutput`\>\"", ",", 
                  RowBox[{"RunProcess", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    "\"\<winepath\>\"", ",", "\"\<-w\>\"", ",", "file"}], 
                    "}"}], "]"}]}], "]"}], "//", "StringTrim"}]}], "}"}], 
             "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"fileNetlist", "=", 
           RowBox[{"FileNameJoin", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"FileNameDrop", "[", "file", "]"}], ",", 
              RowBox[{
               RowBox[{"FileBaseName", "[", "file", "]"}], "<>", 
               "\"\<.net\>\""}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"qharsNetlist", "=", 
           RowBox[{"Import", "[", 
            RowBox[{"fileNetlist", ",", "\"\<Text\>\""}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "The", " ", "program", " ", "extracts", " ", "the", " ", "list", 
            " ", "of", " ", "the", " ", "QHE", " ", "element", " ", "and", 
            " ", "resistance", " ", 
            RowBox[{"nodes", ".", " ", "The"}], " ", "type", " ", "of", " ", 
            "the", " ", "QHE", " ", "element", " ", 
            RowBox[{"(", 
             RowBox[{"CW", " ", "or", " ", "CCW"}], ")"}], " ", "is", " ", 
            "also", " ", "taken", " ", "into", " ", 
            RowBox[{"accout", "."}]}], "*)"}], "  ", "\[IndentingNewLine]", 
          RowBox[{"qharsList", "=", 
           RowBox[{
            RowBox[{"SortBy", "[", 
             RowBox[{
              RowBox[{"ToExpression", "@", 
               RowBox[{"StringSplit", "[", 
                RowBox[{
                 RowBox[{"StringReplace", "[", 
                  RowBox[{
                   RowBox[{"StringCases", "[", 
                    RowBox[{"qharsNetlist", ",", 
                    RowBox[{"StartOfLine", "~~", 
                    RowBox[{
                    "RegularExpression", "[", "\"\<XU[^\\n]+\\n\>\"", 
                    "]"}]}]}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<qhecw\>\"", "\[Rule]", "\"\<N0\>\""}], ",", 
                    RowBox[{"\"\<qheccw\>\"", "\[Rule]", "\"\<N1\>\""}]}], 
                    "}"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"\"\<XU\>\"", ",", 
                   RowBox[{"Whitespace", "~~", "\"\<N\>\""}]}], "}"}]}], 
                "]"}]}], ",", "First"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", 
              RowBox[{"2", ";;"}]}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"qheType", "=", 
           RowBox[{"qharsList", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", 
              RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"qheNodes", "=", 
           RowBox[{"qharsList", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", 
              RowBox[{"1", ";;", 
               RowBox[{"-", "2"}]}]}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"resistorNodes", "=", 
           RowBox[{
            RowBox[{"SortBy", "[", 
             RowBox[{
              RowBox[{"ToExpression", "@", 
               RowBox[{
                RowBox[{"StringSplit", "[", 
                 RowBox[{
                  RowBox[{"StringCases", "[", 
                   RowBox[{"qharsNetlist", ",", 
                    RowBox[{"StartOfLine", "~~", 
                    RowBox[{
                    "RegularExpression", "[", "\"\<R[^\\n]+\\n\>\"", 
                    "]"}]}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"\"\<R\>\"", ",", 
                    RowBox[{"Whitespace", "~~", "\"\<N\>\""}]}], "}"}]}], 
                 "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", 
                  RowBox[{"1", ";;", 
                   RowBox[{"-", "2"}]}]}], "]"}], "]"}]}], ",", "First"}], 
             "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", 
              RowBox[{"2", ";;"}]}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"n", "=", 
           RowBox[{
            RowBox[{"Dimensions", "[", "qheNodes", "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", 
          RowBox[{"(*", 
           RowBox[{
           "The", " ", "number", " ", "of", " ", "QHE", " ", "elements", " ", 
            "in", " ", "the", " ", 
            RowBox[{"QHARS", "."}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"m", "=", 
           RowBox[{
            RowBox[{"Dimensions", "[", "qheNodes", "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ";", 
          RowBox[{"(*", 
           RowBox[{
           "The", " ", "number", " ", "of", " ", "the", " ", "QHE", " ", 
            "element", " ", 
            RowBox[{"terminals", "."}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"l", "=", 
           RowBox[{
            RowBox[{"Dimensions", "[", "resistorNodes", "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", 
          RowBox[{"(*", 
           RowBox[{
           "The", " ", "number", " ", "of", " ", "resistances", " ", "in", 
            " ", "the", " ", 
            RowBox[{"QHARS", "."}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"qharsNodes", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"qheNodes", ",", "resistorNodes"}], "]"}]}], ";", " ", 
          RowBox[{"(*", 
           RowBox[{
           "The", " ", "list", " ", "of", " ", "the", " ", "QHARS", " ", 
            RowBox[{"nodes", "."}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"rows", "=", 
           RowBox[{
            RowBox[{"n", " ", "m"}], "+", 
            RowBox[{"2", "l"}]}]}], ";", " ", 
          RowBox[{"(*", 
           RowBox[{"The", " ", "number", " ", "of", " ", 
            RowBox[{"nodes", "."}]}], "*)"}], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "The", " ", "program", " ", "creates", " ", "the", " ", 
            "interconnection", " ", "\[ScriptCapitalA]", " ", 
            RowBox[{"matrix", "."}]}], "*)"}], " ", "\[IndentingNewLine]", 
          RowBox[{"\[ScriptCapitalA]", "=", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", 
              RowBox[{"rows", ",", 
               RowBox[{"Max", "[", "qharsNodes", "]"}]}], "}"}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"\[ScriptCapitalA]", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"Flatten", "[", "qharsNodes", "]"}], "[", 
                RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}], "=", "1"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "rows"}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"CreateWindow", "[", 
           RowBox[{
            RowBox[{"CreateDialog", "[", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Column", "[", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<sample size \>\"", ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", "s", "]"}], ",", "Number", ",", 
                    RowBox[{"ImageSize", "\[Rule]", "70"}]}], "]"}]}], "}"}], 
                   "]"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<working precision \>\"", ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", "wp", "]"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "150"}]}], "]"}]}], "}"}],
                    "]"}]}], "\[IndentingNewLine]", "}"}], "]"}], ",", 
               RowBox[{"CancelButton", "[", 
                RowBox[{"\"\<OK\>\"", ",", 
                 RowBox[{"DialogReturn", "[", "]"}], ",", 
                 RowBox[{"ImageSize", "\[Rule]", "100"}]}], "]"}]}], 
              "\[IndentingNewLine]", "}"}], "]"}], ",", 
            RowBox[{"WindowFloating", "\[Rule]", "True"}], ",", 
            RowBox[{"WindowSize", "\[Rule]", "Fit"}], ",", " ", 
            RowBox[{
            "WindowTitle", "\[Rule]", "\"\<Choose the parameters\>\""}]}], 
           "\[IndentingNewLine]", "]"}]}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ImageSize", "\[Rule]", "180"}], ",", 
      RowBox[{"Background", "\[Rule]", "Orange"}], ",", 
      RowBox[{"BaseStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"14", ",", "Bold", ",", "White"}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Method", "\[Rule]", "\"\<Queued\>\""}]}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7025580069694695`*^9, 3.702558031381327*^9}, {
   3.70255831456085*^9, 3.7025583325644045`*^9}, {3.70255842076707*^9, 
   3.7025584372964673`*^9}, {3.702558475272485*^9, 3.7025585061874666`*^9}, {
   3.7025585938576574`*^9, 3.7025585953032675`*^9}, {3.702558687254819*^9, 
   3.7025586885136337`*^9}, {3.70255879397894*^9, 3.702558794897917*^9}, {
   3.702558853178014*^9, 3.702558919830378*^9}, {3.7025589771231413`*^9, 
   3.7025589999107237`*^9}, 3.7025593474815626`*^9, {3.7025594568729057`*^9, 
   3.7025594606000595`*^9}, {3.702559529326451*^9, 3.702559566385664*^9}, {
   3.702559610149643*^9, 3.7025596720814447`*^9}, {3.702559705198332*^9, 
   3.7025597395630336`*^9}, {3.702559782399869*^9, 3.7025598532825003`*^9}, {
   3.7025599560379705`*^9, 3.702559968282271*^9}, {3.702560008838525*^9, 
   3.702560009627473*^9}, {3.7025647998672204`*^9, 3.702564826460186*^9}, {
   3.702564898626207*^9, 3.7025648992162466`*^9}, {3.7025649881503444`*^9, 
   3.702564992880655*^9}, 3.7025650323129644`*^9, {3.7025650737060084`*^9, 
   3.702565076660772*^9}, {3.702565168368645*^9, 3.7025652105726914`*^9}, {
   3.702565267080106*^9, 3.7025652752097015`*^9}, {3.7025653490073833`*^9, 
   3.7025654252035685`*^9}, {3.702565460785454*^9, 3.702565464905719*^9}, {
   3.7025654986578465`*^9, 3.702565550902711*^9}, {3.702565931141303*^9, 
   3.7025659476890936`*^9}, {3.702566068157915*^9, 3.702566098481533*^9}, {
   3.702566375489544*^9, 3.7025664388697186`*^9}, 3.7025666420740366`*^9, {
   3.7025666801485844`*^9, 3.702566703679459*^9}, {3.702566887718285*^9, 
   3.702566918962496*^9}, {3.702567048297221*^9, 3.7025670561681857`*^9}, 
   3.7025671339128294`*^9, {3.702567559261239*^9, 3.7025675597512527`*^9}, {
   3.7025678337284403`*^9, 3.702567859822021*^9}, {3.7025679582161493`*^9, 
   3.702567966093711*^9}, {3.702568012700348*^9, 3.7025680148390355`*^9}, {
   3.702568218005653*^9, 3.702568250477235*^9}, {3.7025683553517647`*^9, 
   3.702568426852761*^9}, {3.7025686286632586`*^9, 3.702568638028064*^9}, {
   3.7025686680455956`*^9, 3.70256870653411*^9}, {3.702568767128857*^9, 
   3.702568795214841*^9}, {3.702568835989262*^9, 3.7025688392888093`*^9}, {
   3.702568990960225*^9, 3.7025690259411154`*^9}, 3.7025691020737057`*^9, {
   3.7025694085455008`*^9, 3.702569408885524*^9}, {3.702569485876196*^9, 
   3.7025694916794004`*^9}, 3.7025695381952343`*^9, 3.702570526798809*^9, {
   3.7025706733693123`*^9, 3.7025706741293373`*^9}, {3.702570835252993*^9, 
   3.7025708388304586`*^9}, {3.7025709192042055`*^9, 3.702570920504325*^9}, {
   3.7025714249952145`*^9, 3.7025714525576077`*^9}, 3.702573346742682*^9, {
   3.7025735385532455`*^9, 3.7025736559077497`*^9}, {3.702574028426596*^9, 
   3.702574058228342*^9}, {3.7025741028952494`*^9, 3.70257410482539*^9}, {
   3.7025741454165487`*^9, 3.702574146406618*^9}, {3.7025749701679764`*^9, 
   3.7025750010298586`*^9}, {3.7025750407316456`*^9, 
   3.7025750543259315`*^9}, {3.7025750992471294`*^9, 3.702575112363082*^9}, {
   3.702575842343685*^9, 3.7025758442538176`*^9}, 3.702578244662202*^9, {
   3.702579277838849*^9, 3.7025793732706738`*^9}, {3.7025794046406856`*^9, 
   3.7025794183916407`*^9}, {3.7025794581732626`*^9, 3.702579500739257*^9}, {
   3.7025795378960123`*^9, 3.702579543136362*^9}, {3.7025797116777143`*^9, 
   3.7025797297778406`*^9}, 3.702580337769552*^9, {3.7025805472648935`*^9, 
   3.702580571256446*^9}, {3.7026106586094255`*^9, 3.702610684751215*^9}, {
   3.7026107205409765`*^9, 3.7026107828552494`*^9}, {3.7026108591375113`*^9, 
   3.702610859227482*^9}, {3.702610899230291*^9, 3.702610901910459*^9}, {
   3.702610969635687*^9, 3.7026110022266846`*^9}, 3.7026117639604616`*^9, {
   3.702612103881939*^9, 3.7026121102223897`*^9}, {3.7026128986096997`*^9, 
   3.7026130665961933`*^9}, {3.702614549728997*^9, 3.7026145598692846`*^9}, {
   3.7026145957056026`*^9, 3.70261461213205*^9}, 3.7026180578024907`*^9, {
   3.70261837887354*^9, 3.702618395701857*^9}, {3.7026184335980663`*^9, 
   3.7026184500239906`*^9}, {3.7026185153516493`*^9, 3.702618576396782*^9}, {
   3.702618606551069*^9, 3.702618663849834*^9}, 3.702618704700457*^9, {
   3.702618903733291*^9, 3.702618929239363*^9}, {3.702618981143236*^9, 
   3.7026189857825594`*^9}, {3.7026190171433506`*^9, 
   3.7026190257172327`*^9}, {3.702619157243395*^9, 3.7026191578248343`*^9}, 
   3.7026192379461155`*^9, {3.7026192923262806`*^9, 3.7026192967902822`*^9}, {
   3.702619327075306*^9, 3.702619330217708*^9}, {3.702622641609602*^9, 
   3.702622671958143*^9}, {3.702625394473398*^9, 3.70262539913409*^9}, {
   3.7026254296950474`*^9, 3.7026254362060423`*^9}, {3.702625537639239*^9, 
   3.702625545690183*^9}, {3.70262593155735*^9, 3.7026259371277227`*^9}, 
   3.702628462196353*^9, {3.702630824081544*^9, 3.7026308403871427`*^9}, {
   3.7026308730478563`*^9, 3.7026308921411867`*^9}, {3.7026309264075203`*^9, 
   3.7026309434620776`*^9}, {3.7026309824109097`*^9, 
   3.7026310379369035`*^9}, {3.7026311105412097`*^9, 3.702631127805831*^9}, {
   3.7026312595201855`*^9, 3.7026312715509977`*^9}, {3.702631380465519*^9, 
   3.70263139019797*^9}, 3.7026318311314297`*^9, {3.702631883427419*^9, 
   3.702631908009102*^9}, 3.7026319455005217`*^9, {3.7026321287955728`*^9, 
   3.7026321289256077`*^9}, {3.702635383095791*^9, 3.7026354096751747`*^9}, {
   3.702635475397139*^9, 3.70263573396043*^9}, {3.7026358468944664`*^9, 
   3.7026358917037363`*^9}, {3.7026361718833623`*^9, 
   3.7026361817740755`*^9}, {3.7026364572102923`*^9, 3.702636480089383*^9}, {
   3.70263657829554*^9, 3.7026366108090353`*^9}, {3.7026366482544184`*^9, 
   3.7026366648906784`*^9}, 3.7026367033162656`*^9, {3.702636942632524*^9, 
   3.702636944572714*^9}, {3.702637166084158*^9, 3.7026371846237345`*^9}, {
   3.7026374269284368`*^9, 3.7026374450221753`*^9}, {3.702637482613676*^9, 
   3.702637499859847*^9}, {3.7026379135467887`*^9, 3.7026379143068376`*^9}, 
   3.702637955117449*^9, {3.7026379853132553`*^9, 3.7026380134312115`*^9}, {
   3.7026380585750265`*^9, 3.7026381208820252`*^9}, 3.702638184444556*^9, {
   3.702657702674862*^9, 3.7026577045749884`*^9}, 3.7026579807157717`*^9, {
   3.7026582071969175`*^9, 3.702658211697117*^9}, {3.7026586177921286`*^9, 
   3.702658621085943*^9}, {3.702659601125558*^9, 3.702659656579273*^9}, {
   3.7026597538549104`*^9, 3.702659762821849*^9}, {3.7026598230243955`*^9, 
   3.7026598506481075`*^9}, {3.7028099781750135`*^9, 3.7028100000866857`*^9}, 
   3.702811653593278*^9, {3.7028117117462845`*^9, 3.702811738253255*^9}, 
   3.702812207781198*^9, {3.7028123203698564`*^9, 3.70281232369011*^9}, 
   3.7028124251520996`*^9, {3.7028128538038163`*^9, 3.7028128554438567`*^9}, 
   3.702812901685536*^9, {3.702812935596733*^9, 3.7028130553419895`*^9}, {
   3.7028130934738903`*^9, 3.7028130964939814`*^9}, {3.702813135345866*^9, 
   3.7028132979739513`*^9}, {3.7028133509372334`*^9, 3.702813354517434*^9}, {
   3.7028136124606404`*^9, 3.7028136249714127`*^9}, {3.702813824557793*^9, 
   3.702813825297866*^9}, {3.702813981860236*^9, 3.702813981969311*^9}, {
   3.702814052414852*^9, 3.7028140542581835`*^9}, {3.7028742647773595`*^9, 
   3.7028743004534254`*^9}, {3.7028743372092223`*^9, 
   3.7028743569687366`*^9}, {3.7028744773567557`*^9, 3.702874506936298*^9}, {
   3.7028751682841206`*^9, 3.7028752629561586`*^9}, {3.702875369330837*^9, 
   3.702875387152291*^9}, {3.7028761155613832`*^9, 3.7028761239018364`*^9}, 
   3.702876214092945*^9, {3.7028762566244974`*^9, 3.7028763171647654`*^9}, 
   3.702876415185835*^9, {3.702876791653161*^9, 3.7028768004624605`*^9}, {
   3.7028768846006403`*^9, 3.702876891355468*^9}, {3.7028769229319754`*^9, 
   3.702876933640562*^9}, {3.702877139509512*^9, 3.7028771400895495`*^9}, {
   3.7028772411400776`*^9, 3.7028772586580477`*^9}, {3.7028854498937836`*^9, 
   3.7028854908907795`*^9}, {3.7028858400971212`*^9, 3.702885866369855*^9}, {
   3.702886139582836*^9, 3.702886174266956*^9}, {3.702886206330395*^9, 
   3.7028862519883833`*^9}, {3.702893062278847*^9, 3.70289306512391*^9}, {
   3.7028935445060387`*^9, 3.702893545916053*^9}, {3.702983637035313*^9, 
   3.70298364392383*^9}, {3.7029837252115326`*^9, 3.702983918849349*^9}, {
   3.702983956856124*^9, 3.7029839707221947`*^9}, {3.7029840708302965`*^9, 
   3.702984077308633*^9}, {3.7029852381039104`*^9, 3.7029854152074165`*^9}, {
   3.7029854527099457`*^9, 3.702985474937928*^9}, {3.702985531601415*^9, 
   3.702985535031664*^9}, {3.703239468596464*^9, 3.703239472506673*^9}, {
   3.703239595414492*^9, 3.70323961393743*^9}, 3.7033894985449677`*^9, {
   3.703389790411808*^9, 3.7033898061928854`*^9}, 3.7033905600018697`*^9, 
   3.703390636977322*^9, {3.7033906681095023`*^9, 3.703390669049529*^9}, {
   3.7033907229718513`*^9, 3.70339073271253*^9}, {3.7033907713023252`*^9, 
   3.7033907827531285`*^9}, {3.7033913325559483`*^9, 3.703391369610049*^9}, {
   3.70342273243265*^9, 3.703422764817813*^9}, {3.703422920874855*^9, 
   3.7034231374740114`*^9}, 3.7034232842260284`*^9, {3.7034233368016796`*^9, 
   3.7034233433541384`*^9}, 3.703423386077134*^9, {3.7034737807959347`*^9, 
   3.703473784306288*^9}, {3.703473934490822*^9, 3.703473957712617*^9}, {
   3.703474635358282*^9, 3.703474662468525*^9}, 3.703519663418172*^9, {
   3.703519731543936*^9, 3.7035198533877106`*^9}, {3.7035199494120045`*^9, 
   3.7035199512819223`*^9}, {3.703520232922214*^9, 3.7035202407547407`*^9}, {
   3.7035214920345225`*^9, 3.7035215671500587`*^9}, {3.703522985593707*^9, 
   3.7035229953630247`*^9}, {3.703561753739073*^9, 3.703561767703556*^9}, {
   3.703561990770604*^9, 3.703562014719787*^9}, {3.703562185305517*^9, 
   3.7035621894896464`*^9}, {3.70384350202516*^9, 3.703843508272706*^9}, {
   3.70384354956883*^9, 3.703843552145028*^9}, {3.703843583261469*^9, 
   3.703843612546741*^9}, {3.703843965613967*^9, 3.70384397872311*^9}, {
   3.7038445979152203`*^9, 3.70384460561697*^9}, 3.70384471044985*^9, {
   3.70384882822421*^9, 3.703848844455613*^9}, {3.7046264722886906`*^9, 
   3.7046264744398117`*^9}, {3.7046320077319155`*^9, 3.704632011730595*^9}, {
   3.7046322141209116`*^9, 3.704632318754689*^9}, {3.704632387192091*^9, 
   3.704632420451501*^9}, {3.7046324506742024`*^9, 3.704632613901983*^9}, {
   3.7046326453934045`*^9, 3.70463268797338*^9}, {3.7046327342110243`*^9, 
   3.7046327379486384`*^9}, {3.7046327706335993`*^9, 
   3.7046328367777057`*^9}, {3.704632887961095*^9, 3.704632891110354*^9}, 
   3.704632940644444*^9, {3.7046331501393423`*^9, 3.70463321774445*^9}, {
   3.7046335511549697`*^9, 3.704633555718772*^9}, {3.7046336092164803`*^9, 
   3.704633616208562*^9}, {3.7046337066648655`*^9, 3.7046337989729156`*^9}, {
   3.704633831048374*^9, 3.7046338341908693`*^9}, 3.704633912562362*^9, {
   3.70463407635902*^9, 3.704634077497868*^9}, {3.704634117168145*^9, 
   3.704634117633295*^9}, {3.704634224232873*^9, 3.7046342302689505`*^9}, {
   3.704634274751253*^9, 3.7046342784673767`*^9}, {3.7046343292058506`*^9, 
   3.704634333048354*^9}, {3.7046344513400364`*^9, 3.704634472788313*^9}, {
   3.7046346087374134`*^9, 3.7046346156620665`*^9}, {3.704693588840204*^9, 
   3.704693590165911*^9}, {3.704695875585308*^9, 3.704695921364355*^9}, {
   3.704695974813447*^9, 3.7046960096451426`*^9}, {3.704696061351794*^9, 
   3.7046960874659543`*^9}, {3.7046963466774144`*^9, 3.704696348728606*^9}, {
   3.704696512521285*^9, 3.704696530167124*^9}, {3.7046965651342783`*^9, 
   3.7046966120695868`*^9}, {3.704696681855931*^9, 3.704696712168973*^9}, {
   3.7046967589764013`*^9, 3.7046967600308075`*^9}, {3.7046968076984725`*^9, 
   3.704696868571996*^9}, {3.7046969337895627`*^9, 3.7046970548042936`*^9}, {
   3.704697231579544*^9, 3.704697368206456*^9}, {3.7046977326742034`*^9, 
   3.704697761761407*^9}, {3.7046978381975193`*^9, 3.7046979120549974`*^9}, {
   3.7046979913698397`*^9, 3.7046981172572675`*^9}, {3.7046981781450815`*^9, 
   3.7046982246580877`*^9}, {3.7046982615775185`*^9, 3.704698297162158*^9}, {
   3.7046983424138236`*^9, 3.7046983744439135`*^9}, {3.7046984126509805`*^9, 
   3.70469844216031*^9}, {3.704698513897744*^9, 3.704698602090479*^9}, {
   3.7046986367196407`*^9, 3.704698639073954*^9}, {3.7046986816485777`*^9, 
   3.704698687985403*^9}, {3.7046987359354506`*^9, 3.7046987523356276`*^9}, {
   3.7046987940482674`*^9, 3.704698795088027*^9}, {3.7046988312436123`*^9, 
   3.704698872619656*^9}, {3.704698903126424*^9, 3.7046989985331388`*^9}, {
   3.704699035911929*^9, 3.70469908610188*^9}, {3.704699133664796*^9, 
   3.7046992395705385`*^9}, {3.704699276172553*^9, 3.7046993197312546`*^9}, {
   3.70469943380599*^9, 3.704699444888966*^9}, {3.7046996866300907`*^9, 
   3.704699689020328*^9}, 3.704700028442342*^9, {3.7047000650479584`*^9, 
   3.7047000710968866`*^9}, {3.7047001275878663`*^9, 3.704700237370906*^9}, {
   3.7047002907398643`*^9, 3.7047003678828926`*^9}, 3.7047004470870705`*^9, {
   3.7047005332382183`*^9, 3.704700578249488*^9}, {3.7047023485030904`*^9, 
   3.7047024002541766`*^9}, {3.704702430506689*^9, 3.704702508068863*^9}, {
   3.704702561905549*^9, 3.704702593675458*^9}, 3.704702878680064*^9, {
   3.704702911944806*^9, 3.7047029996908445`*^9}, {3.7047037361589108`*^9, 
   3.7047037724248314`*^9}, {3.7047039695237274`*^9, 3.704704009815813*^9}, {
   3.7047040684467525`*^9, 3.704704072183817*^9}, {3.7047041098539715`*^9, 
   3.70470418927803*^9}, {3.7047042519427414`*^9, 3.704704273835677*^9}, {
   3.704704478189059*^9, 3.704704482431785*^9}, {3.7047046937004023`*^9, 
   3.7047046955114994`*^9}, {3.7047087981895456`*^9, 3.70470879875941*^9}, {
   3.7047100973774576`*^9, 3.704710099450133*^9}, {3.704710287069398*^9, 
   3.7047103464907665`*^9}, {3.7047106262840366`*^9, 
   3.7047106670435257`*^9}, {3.704714991393003*^9, 3.704714992596203*^9}, {
   3.7184481637799053`*^9, 3.718448206920334*^9}, {3.718448721158613*^9, 
   3.7184487323978157`*^9}, 3.718448785230279*^9, {3.718449418342396*^9, 
   3.7184494272051897`*^9}, {3.718449552590109*^9, 3.718449553740943*^9}, {
   3.7184495914023542`*^9, 3.718449599733529*^9}, {3.71844969539279*^9, 
   3.718449727979821*^9}, {3.718449846294087*^9, 3.718449861926688*^9}, 
   3.718450048167869*^9, {3.718450078230962*^9, 3.718450083229782*^9}, {
   3.718450121229375*^9, 3.7184501285978117`*^9}, 3.7184504168721333`*^9, {
   3.71845047253472*^9, 3.718450478815765*^9}, {3.7184530412305293`*^9, 
   3.7184530516612415`*^9}, 3.7184532329199896`*^9, {3.718453341383786*^9, 
   3.718453345100843*^9}, {3.7186943835540667`*^9, 3.718694386729453*^9}, {
   3.718694738002287*^9, 3.718694871104782*^9}, 3.718695944110917*^9, {
   3.7187045221316156`*^9, 3.7187045235125427`*^9}, {3.7187045887322235`*^9, 
   3.7187046116793776`*^9}, {3.7187046606041145`*^9, 3.718704708840849*^9}, {
   3.7187048134451475`*^9, 3.7187048215695906`*^9}, {3.7187049503881817`*^9, 
   3.7187049597268457`*^9}, {3.7187101134809237`*^9, 
   3.7187101139912033`*^9}, {3.71922802263717*^9, 3.71922805562766*^9}, {
   3.719228112173644*^9, 3.719228274729618*^9}, {3.719228338761572*^9, 
   3.7192284370291023`*^9}, {3.719228471556179*^9, 3.7192288063087564`*^9}, {
   3.7192302520041256`*^9, 3.7192303652041717`*^9}, {3.7192305440101604`*^9, 
   3.719230639206348*^9}, {3.720160562707048*^9, 3.7201605630981617`*^9}, {
   3.720161188833967*^9, 3.720161193621608*^9}, {3.720161267009016*^9, 
   3.7201612791995573`*^9}},ExpressionUUID->"9db3d987-d955-430a-8827-\
87ac78131ff8"],

Cell[BoxData[
 ButtonBox["\<\"Load QHARS Schematic\"\>",
  Appearance->Automatic,
  Background->RGBColor[1, 0.5, 0],
  BaseStyle->{14, Bold, 
    GrayLevel[1]},
  ButtonFunction:>($CellContext`n = 0; $CellContext`m = 0; $CellContext`l = 
    0; $CellContext`\[ScriptCapitalA] = {}; $CellContext`rQn = 
    1/1; $CellContext`wp = 4 MachinePrecision; $CellContext`s = 
    1; $CellContext`a = 0; $CellContext`b = 0; $CellContext`c = 
    0; $CellContext`d = 
    0; $CellContext`tList = {
     1, 3.16227766017`12., 10, 31.6227766017`12., 
      100}; $CellContext`fileAnnotated = ""; $CellContext`fileLog = 
    ""; $CellContext`file = SystemDialogInput["FileOpen", {
       NotebookDirectory[], {
       "LTspice schematic" -> {"*.asc"}, "All files" -> {"*.*"}}}, 
      WindowTitle -> "Choose the QHARS schematic"]; 
   If[$CellContext`file =!= $Canceled, $CellContext`qharsSchematic$1089 = 
      Import[$CellContext`file, "Text"]; ToExpression[
       StringReplace[
        StringCases[$CellContext`qharsSchematic$1089, 
         RegularExpression[
         "p/q\\s*=.+|a\\s*=.+|b\\s*=.+|c\\s*=.+|d\\s*=.+"]], {
        "p/q" -> "rQn"}]]; $CellContext`qharsSchematicAnnotated$1089 = 
      StringJoin[
        StringReplace[$CellContext`qharsSchematic$1089, {
         RegularExpression["SYMATTR InstName U(\\d+)"] :> 
          StringJoin[
           "SYMATTR InstName U$1\nSYMATTR Value E1={E$1", "1} E2={E$1", 
            "2} E3={E$1", "3} E4={E$1", "4} E5={E$1", "5} E6={E$1", 
            "6} E7={E$1", "7} E8={E$1", "8}"], 
          RegularExpression["SYMATTR InstName R(\\d+)"] :> 
          "SYMATTR InstName R$1\nSYMATTR Value {R$1}", 
          RegularExpression[
           ";\\s*rQn\\s*=.+|;\\s*a\\s*=.+|;\\s*b\\s*=.+|;\\s*c\\s*=.+|d\\s*=.+\
"] -> TemplateApply[
           "!.inc `fileBaseName`_parameters.net\\n.step param t LIST \
`tList`\\n.meas AC err AVG `rQden`*mag(V(N`a`,N`b`))/`rQnum`-1\\n.ac dec 10 1 \
10\\nI1 0 N`c` AC 1\\nR1000 N`d` 0 1e-3", 
            Association["d" -> StringPadLeft[
               ToString[$CellContext`d], 3, "0"], "c" -> StringPadLeft[
               ToString[$CellContext`c], 3, "0"], "b" -> StringPadLeft[
               ToString[$CellContext`b], 3, "0"], "a" -> StringPadLeft[
               ToString[$CellContext`a], 3, "0"], "rQden" -> 
             Denominator[$CellContext`rQn], "rQnum" -> 
             Numerator[$CellContext`rQn], "fileBaseName" -> 
             FileBaseName[$CellContext`file], "tList" -> 
             StringRiffle[$CellContext`tList]]]}], "\\n", ".inc qhecw.sub", 
        "\\n", ".inc qheccw.sub"]; $CellContext`fileAnnotated = FileNameJoin[{
         FileNameDrop[$CellContext`file], 
         StringJoin[
          FileBaseName[$CellContext`file], "_annotated.", 
          FileExtension[$CellContext`file]]}]; $CellContext`fileLog = 
      FileNameJoin[{
         FileNameDrop[$CellContext`fileAnnotated], 
         StringJoin[
          FileBaseName[$CellContext`fileAnnotated], ".log"]}]; 
     Export[$CellContext`fileAnnotated, \
$CellContext`qharsSchematicAnnotated$1089, "Text"]; 
     Switch[$OperatingSystem, "Windows", 
       RunProcess[{"XVIIx64.exe", "-netlist", $CellContext`file}], "Unix", 
       RunProcess[{"wine", "XVIIx64.exe", "-netlist", 
         StringTrim[
          TemplateApply["`StandardOutput`", 
           
           RunProcess[{
            "winepath", 
             "-w", $CellContext`file}]]]}]]; $CellContext`fileNetlist$1089 = 
      FileNameJoin[{
         FileNameDrop[$CellContext`file], 
         StringJoin[
          FileBaseName[$CellContext`file], 
          ".net"]}]; $CellContext`qharsNetlist$1089 = 
      Import[$CellContext`fileNetlist$1089, 
        "Text"]; $CellContext`qharsList$1089 = Part[
        SortBy[
         ToExpression[
          StringSplit[
           StringReplace[
            StringCases[$CellContext`qharsNetlist$1089, 
             StringExpression[StartOfLine, 
              RegularExpression["XU[^\n]+\n"]]], {
            "qhecw" -> "N0", "qheccw" -> "N1"}], {"XU", 
            StringExpression[Whitespace, "N"]}]], First], All, 
        Span[2, All]]; $CellContext`qheType = 
      Part[$CellContext`qharsList$1089, All, -1]; $CellContext`qheNodes$1089 = 
      Part[$CellContext`qharsList$1089, All, 
        Span[1, -2]]; $CellContext`resistorNodes$1089 = Part[
        SortBy[
         ToExpression[
          Part[
           StringSplit[
            StringCases[$CellContext`qharsNetlist$1089, 
             StringExpression[StartOfLine, 
              RegularExpression["R[^\n]+\n"]]], {"R", 
             StringExpression[Whitespace, "N"]}], All, 
           Span[1, -2]]], First], All, 
        Span[2, All]]; $CellContext`n = Part[
        Dimensions[$CellContext`qheNodes$1089], 1]; $CellContext`m = Part[
        Dimensions[$CellContext`qheNodes$1089], 2]; $CellContext`l = Part[
        Dimensions[$CellContext`resistorNodes$1089], 
        1]; $CellContext`qharsNodes$1089 = 
      Join[$CellContext`qheNodes$1089, $CellContext`resistorNodes$1089]; \
$CellContext`rows$1089 = $CellContext`n $CellContext`m + 
       2 $CellContext`l; $CellContext`\[ScriptCapitalA] = 
      ConstantArray[0, {$CellContext`rows$1089, 
         Max[$CellContext`qharsNodes$1089]}]; Table[Part[
         Part[$CellContext`\[ScriptCapitalA], $CellContext`k], 
         Part[
          Flatten[$CellContext`qharsNodes$1089], $CellContext`k]] = 
       1, {$CellContext`k, $CellContext`rows$1089}]; CreateWindow[
       CreateDialog[{
         Column[{
           Row[{"sample size ", 
             InputField[
              Dynamic[$CellContext`s], Number, ImageSize -> 70]}], 
           Row[{"working precision ", 
             InputField[
              Dynamic[$CellContext`wp], ImageSize -> 150]}]}], 
         CancelButton["OK", 
          DialogReturn[], ImageSize -> 100]}], WindowFloating -> True, 
       WindowSize -> Fit, WindowTitle -> "Choose the parameters"]]),
  Evaluator->Automatic,
  ImageSize->180,
  Method->"Queued"]], "Output",
 CellChangeTimes->{
  3.7047030002947707`*^9, {3.70470376159737*^9, 3.7047037774265165`*^9}, {
   3.7047041660102663`*^9, 3.704704192140155*^9}, {3.7047042649051275`*^9, 
   3.7047042741674013`*^9}, 3.7047044835375357`*^9, {3.704704697922057*^9, 
   3.704704701541394*^9}, 3.7047086097366505`*^9, 3.704708801845752*^9, 
   3.704709018811883*^9, {3.704710074740817*^9, 3.7047101018937316`*^9}, 
   3.7047102926797514`*^9, 3.7047103472721124`*^9, {3.7047106454910536`*^9, 
   3.704710668587981*^9}, 3.704712177432604*^9, 3.704715005414918*^9, 
   3.704732145880395*^9, 3.704775043536458*^9, 3.7047752553285522`*^9, 
   3.704779005926159*^9, 3.704792558568941*^9, 3.704800331758651*^9, 
   3.70506006603139*^9, 3.705122844088718*^9, 3.705123118854808*^9, 
   3.7051235941488056`*^9, 3.7051305989334326`*^9, 3.7051438993889484`*^9, 
   3.70514447902243*^9, 3.705146277154105*^9, 3.705146873117526*^9, 
   3.7052099676154647`*^9, 3.7052100867706203`*^9, 3.7052102734307575`*^9, 
   3.718448062673419*^9, 3.7184482147523003`*^9, 3.718448758287363*^9, 
   3.7184487946607037`*^9, 3.7184497481414824`*^9, 3.7184498782989473`*^9, {
   3.718450146715773*^9, 3.718450146885419*^9}, 3.718450449153813*^9, 
   3.718450525402781*^9, 3.7184533784759007`*^9, {3.718455117245082*^9, 
   3.7184551322906513`*^9}, 3.7184564856686287`*^9, 3.7186933230912123`*^9, 
   3.71869609225005*^9, 3.7186981746598716`*^9, 3.718704855974832*^9, 
   3.7187049725237637`*^9, 3.7187056576101427`*^9, 3.7187095757291307`*^9},
 ExpressionUUID -> "93ea5d85-48a9-4864-b84e-715d587ab160"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"fileExcel", "=", "\"\<\>\""}], ",", 
      RowBox[{"epsilonLimits", "=", "\"\<\>\""}], ",", 
      RowBox[{"epsilonLimitsDropped", "=", "\"\<\>\""}], ",", 
      RowBox[{"deltaLimits", "=", "\"\<\>\""}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Button", "[", 
     RowBox[{
     "\"\<Load stray parameters Excel spreadsheet\>\"", ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[ScriptCapitalY]i", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"qheType", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "==", "0"}], ",", 
            RowBox[{"qheCwIdeal", "[", "m", "]"}], ",", 
            RowBox[{"qheCcwIdeal", "[", "m", "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{
        "The", " ", "IAM", " ", "matrix", " ", "of", " ", "the", " ", "N", 
         " ", "QHE", " ", 
         RowBox[{"elements", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\[ScriptCapitalA]T", "=", 
        RowBox[{"\[ScriptCapitalA]", "\[Transpose]"}]}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{"Transpose", " ", "of", " ", "the", " ", "matrix", " ", 
         RowBox[{"\[ScriptCapitalA]", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"rnSign", "=", 
        RowBox[{
         RowBox[{"Sign", "[", 
          RowBox[{"c", "-", "d"}], "]"}], 
         RowBox[{"Sign", "[", 
          RowBox[{"a", "-", "b"}], "]"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], "^", 
          RowBox[{"(", 
           RowBox[{"1", "+", "1", "+", "c", "+", "d", "+", "a", "+", "b"}], 
           ")"}]}]}]}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "The", " ", "sign", " ", "operator", " ", "is", " ", "calculated", 
          " ", "from", " ", "the", " ", "parameters", " ", "a"}], ",", "b", 
         ",", 
         RowBox[{"c", " ", "and", " ", 
          RowBox[{"d", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "The", " ", "program", " ", "imports", " ", "the", " ", "Excel", " ", 
         "spreadsheet", " ", "composed", " ", "of", " ", "the", " ", 
         "endpointd", " ", "of", " ", "the", " ", "stray", " ", "parameter", 
         " ", 
         RowBox[{"distributions", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"fileExcel", "=", 
        RowBox[{"SystemDialogInput", "[", 
         RowBox[{"\"\<FileOpen\>\"", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"DirectoryName", "[", "file", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\"\<Excel Files\>\"", "->", 
               RowBox[{"{", "\"\<*.xlsx\>\"", "}"}]}], ",", 
              RowBox[{"\"\<All files\>\"", "->", 
               RowBox[{"{", 
                StyleBox["\"\<*.*\>\"", "TR"], "}"}]}]}], "}"}]}], "}"}], ",", 
          RowBox[{
          "WindowTitle", "\[Rule]", 
           "\"\<Choose the Stray parameters Excel spreadsheet\>\""}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "The", " ", "program", " ", "creates", " ", "a", " ", "list", " ", 
          "of", " ", "the", " ", "enpoints", " ", "of", " ", "the", " ", 
          "NxM", " ", "terminal", " ", "resistances", " ", "extracted", " ", 
          "from", " ", "the", " ", "data", " ", "imported"}], ",", " ", 
         RowBox[{
         "by", " ", "distinguishing", " ", "the", " ", "voltage", " ", "and", 
          " ", "current", " ", 
          RowBox[{"terminals", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"fileExcel", "=!=", "$Canceled"}], ",", 
         RowBox[{"epsilonLimits", "=", 
          RowBox[{"SetPrecision", "[", 
           RowBox[{
            RowBox[{"Import", "[", 
             RowBox[{"fileExcel", ",", 
              RowBox[{"{", 
               RowBox[{"\"\<Data\>\"", ",", "2", ",", "All", ",", 
                RowBox[{"{", 
                 RowBox[{"4", ",", "5"}], "}"}]}], "}"}]}], "]"}], ",", 
            "wp"}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"epsilonLimitsDropped", "=", 
        RowBox[{"Drop", "[", 
         RowBox[{"epsilonLimits", ",", "1"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"epsilonLim", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"epsilonLim", "=", 
             RowBox[{"List", "[", 
              RowBox[{
               RowBox[{"epsilonLimitsDropped", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"epsilonLimitsDropped", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", 
               RowBox[{"epsilonLimitsDropped", "[", 
                RowBox[{"[", "3", "]"}], "]"}], ",", 
               RowBox[{"epsilonLimitsDropped", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", 
               RowBox[{"epsilonLimitsDropped", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"epsilonLimitsDropped", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", 
               RowBox[{"epsilonLimitsDropped", "[", 
                RowBox[{"[", "3", "]"}], "]"}], ",", 
               RowBox[{"epsilonLimitsDropped", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "88"}], "}"}]}], "]"}], ",", "1"}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "The", " ", "program", " ", "creates", " ", "a", " ", "list", " ", 
         "of", " ", "the", " ", "enpoints", " ", "of", " ", "the", " ", "L", 
         " ", "wire", " ", "resistances", " ", "extracted", " ", "from", " ", 
         "the", " ", "data", " ", 
         RowBox[{"imported", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"fileExcel", "=!=", "$Canceled"}], ",", 
         RowBox[{"deltaLimits", "=", 
          RowBox[{"SetPrecision", "[", 
           RowBox[{
            RowBox[{"Import", "[", 
             RowBox[{"fileExcel", ",", 
              RowBox[{"{", 
               RowBox[{"\"\<Data\>\"", ",", "1", ",", "All", ",", 
                RowBox[{"{", 
                 RowBox[{"6", ",", "7"}], "}"}]}], "}"}]}], "]"}], ",", 
            "wp"}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"deltaLim", "=", 
        RowBox[{"Drop", "[", 
         RowBox[{"deltaLimits", ",", "1"}], "]"}]}]}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"ImageSize", "\[Rule]", "190"}], ",", 
      RowBox[{"Background", "\[Rule]", 
       RowBox[{"RGBColor", "[", 
        RowBox[{"0.16", ",", "0.58", ",", "0.07"}], "]"}]}], ",", 
      RowBox[{"BaseStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"14", ",", "Bold", ",", "White"}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Method", "\[Rule]", "\"\<Queued\>\""}]}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.704707276255149*^9, 3.704707279265378*^9}, {
   3.7047073306628714`*^9, 3.704707331537464*^9}, {3.7047073947800293`*^9, 
   3.7047073978175364`*^9}, {3.70470765253259*^9, 3.7047076848239822`*^9}, {
   3.704707718981001*^9, 3.7047077225693045`*^9}, 3.704707755044653*^9, {
   3.704707805230897*^9, 3.704707829354674*^9}, {3.7047078931319885`*^9, 
   3.704707923204166*^9}, {3.70470800696101*^9, 3.7047080598316*^9}, {
   3.7047081647471495`*^9, 3.704708285509468*^9}, {3.704708324762024*^9, 
   3.7047083511703153`*^9}, {3.704708405748579*^9, 3.7047084544303465`*^9}, {
   3.7047085103542423`*^9, 3.7047085413637776`*^9}, {3.704708587616667*^9, 
   3.7047085904601774`*^9}, {3.7047086262533655`*^9, 3.704708666619275*^9}, {
   3.7047087537790484`*^9, 3.704708757777665*^9}, {3.7047088112665677`*^9, 
   3.7047088123660846`*^9}, {3.7047097903510046`*^9, 3.704709805145412*^9}, {
   3.7047099172441225`*^9, 3.704709925442899*^9}, {3.70471035898512*^9, 
   3.7047103947839293`*^9}, {3.7047104453972216`*^9, 3.704710463350467*^9}, {
   3.7047105014212475`*^9, 3.70471050225276*^9}, {3.7047133141871796`*^9, 
   3.7047133174063177`*^9}, {3.7047135569143057`*^9, 3.704713574559419*^9}, {
   3.705130468298673*^9, 3.7051305652519255`*^9}, {3.7051460095597253`*^9, 
   3.705146042806239*^9}, 3.7051460895675325`*^9, {3.718454544482613*^9, 
   3.7184545445612*^9}, {3.71869346434761*^9, 3.718693471178018*^9}, 
   3.718707877221838*^9, {3.719230391457449*^9, 3.719230530721362*^9}, {
   3.71923065414038*^9, 3.7192308384336767`*^9}, {3.719230869032092*^9, 
   3.7192309462121463`*^9}, {3.7192309764195423`*^9, 3.719231095705474*^9}, {
   3.7192312803646917`*^9, 3.719231280850617*^9}},
 ExpressionUUID -> "96d91682-abe4-4c44-8616-430c9bd1f76d"],

Cell[BoxData[
 ButtonBox["\<\"Load stray parameters Excel spreadsheet\"\>",
  Appearance->Automatic,
  Background->RGBColor[0.16, 0.58, 0.07],
  BaseStyle->{14, Bold, 
    GrayLevel[1]},
  ButtonFunction:>($CellContext`\[ScriptCapitalY]i = Table[
      If[Part[$CellContext`qheType, $CellContext`i] == 0, 
       $CellContext`qheCwIdeal[$CellContext`m], 
       $CellContext`qheCcwIdeal[$CellContext`m]], {$CellContext`i, \
$CellContext`n}]; $CellContext`\[ScriptCapitalA]T = 
    Transpose[$CellContext`\[ScriptCapitalA]]; $CellContext`rnSign = 
    Sign[$CellContext`c - $CellContext`d] 
     Sign[$CellContext`a - $CellContext`b] (-1)^(1 + 
       1 + $CellContext`c + $CellContext`d + $CellContext`a + $CellContext`b); \
$CellContext`fileExcel$1095 = SystemDialogInput["FileOpen", {
       DirectoryName[$CellContext`file], {
       "Excel Files" -> {"*.xlsx"}, "All files" -> {"*.*"}}}, WindowTitle -> 
      "Choose the Stray parameters Excel spreadsheet"]; 
   If[$CellContext`fileExcel$1095 =!= $Canceled, \
$CellContext`epsilonLimits$1095 = SetPrecision[
       Import[$CellContext`fileExcel$1095, {
        "Data", 2, All, {4, 
         5}}], $CellContext`wp]]; $CellContext`epsilonLimitsDropped$1095 = 
    Drop[$CellContext`epsilonLimits$1095, 1]; $CellContext`epsilonLim = 
    Flatten[
      Table[$CellContext`epsilonLim = {
         Part[$CellContext`epsilonLimitsDropped$1095, 1], 
         Part[$CellContext`epsilonLimitsDropped$1095, 2], 
         Part[$CellContext`epsilonLimitsDropped$1095, 3], 
         Part[$CellContext`epsilonLimitsDropped$1095, 2], 
         Part[$CellContext`epsilonLimitsDropped$1095, 1], 
         Part[$CellContext`epsilonLimitsDropped$1095, 2], 
         Part[$CellContext`epsilonLimitsDropped$1095, 3], 
         Part[$CellContext`epsilonLimitsDropped$1095, 2]}, {$CellContext`i, 
        88}], 1]; 
   If[$CellContext`fileExcel$1095 =!= $Canceled, \
$CellContext`deltaLimits$1095 = SetPrecision[
       Import[$CellContext`fileExcel$1095, {
        "Data", 1, All, {6, 7}}], $CellContext`wp]]; $CellContext`deltaLim = 
    Drop[$CellContext`deltaLimits$1095, 1]),
  Evaluator->Automatic,
  ImageSize->190,
  Method->"Queued"]], "Output",
 CellChangeTimes->{
  3.705146043526609*^9, 3.7051460904629984`*^9, {3.705146301778732*^9, 
   3.7051463276472225`*^9}, 3.70514687314254*^9, 3.705209990855544*^9, 
   3.70521011047044*^9, 3.705210296564189*^9, 3.718448062713476*^9, 
   3.718448758327963*^9, 3.7184497481810217`*^9, 3.7184498783430767`*^9, 
   3.718450146756682*^9, 3.718450525519466*^9, 3.71845337859385*^9, 
   3.718455117285528*^9, 3.71845648570621*^9, 3.7186933233310947`*^9, 
   3.71869356359881*^9, 3.7186960923579063`*^9, 3.718698174689904*^9, 
   3.7187095757691507`*^9},
 ExpressionUUID -> "7b9eb8d9-a55c-439f-b3ff-41255a0345e5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"epsilonRandom", "=", "\"\<\>\""}], ",", 
     RowBox[{"deltaRandom", "=", "\"\<\>\""}], ",", 
     RowBox[{"\[Epsilon]", "=", "\"\<\>\""}], ",", 
     RowBox[{"\[Delta]", "=", "\"\<\>\""}]}], "}"}], ",", 
   RowBox[{"Button", "[", 
    RowBox[{"\"\<Run the QHARS machine\>\"", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Tau]", "=", " ", 
       RowBox[{"Timing", "[", 
        RowBox[{"(*", 
         RowBox[{
         "The", " ", "time", " ", "needed", " ", "to", " ", "evaluate", " ", 
          "the", " ", 
          RowBox[{"script", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"result", "=", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "The", " ", "program", " ", "extracts", " ", "a", " ", "random", 
             " ", "value", " ", "from", " ", "each", " ", "uniform", " ", 
             "distribution", " ", "identified", " ", "by", " ", "the", " ", 
             RowBox[{"endpoints", "."}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"epsilonRandom", "=", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"RandomReal", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"epsilonLim", "[", 
                    RowBox[{"[", 
                    RowBox[{"v", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"epsilonLim", "[", 
                    RowBox[{"[", 
                    RowBox[{"v", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
                  RowBox[{"WorkingPrecision", "\[Rule]", "wp"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"v", ",", 
                  RowBox[{"n", "*", "m"}]}], "}"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"deltaRandom", "=", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"RandomReal", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"deltaLim", "[", 
                    RowBox[{"[", 
                    RowBox[{"w", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"deltaLim", "[", 
                    RowBox[{"[", 
                    RowBox[{"w", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
                  RowBox[{"WorkingPrecision", "\[Rule]", "wp"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"w", ",", "l"}], "}"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"epsilon", "=", 
              RowBox[{"Flatten", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Epsilon]", "[", 
                   RowBox[{"j", ",", "k"}], "]"}], "\[Rule]", 
                  RowBox[{"epsilonRandom", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}], "*", "m"}], "+", "k"}], 
                    "]"}], "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", "n"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"k", ",", "m"}], "}"}]}], "]"}], "]"}]}], ";", " ", 
             "\n", "               ", 
             RowBox[{"delta", "=", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"\[Delta]", "[", "w", "]"}], "\[Rule]", 
                 RowBox[{"deltaRandom", "[", 
                  RowBox[{"[", "w", "]"}], "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"w", ",", "l"}], "}"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "The", " ", "program", " ", "creates", " ", "the", " ", 
               "matrix", " ", "\[ScriptCapitalD]", " ", "that", " ", 
               "identify", " ", "the", " ", "terminal", " ", 
               RowBox[{"resistances", "."}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"\[ScriptCapitalD]", "=", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"qheType", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "==", "0"}], ",", 
                   RowBox[{"RotateLeft", "[", 
                    RowBox[{
                    RowBox[{"PadLeft", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"\[Epsilon]", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"j", "-", "1"}], ",", "m"}], "]"}], "+", "1"}]}], 
                    "]"}]}], "/", "2"}], " ", ",", 
                    RowBox[{"1", "+", 
                    RowBox[{
                    RowBox[{"\[Epsilon]", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"j", "+", "1"}]}], "]"}], "/", "2"}]}]}], " ", 
                    "}"}], ",", "m"}], "]"}], ",", 
                    RowBox[{"m", "-", "1", "-", "j"}]}], "]"}], ",", 
                   RowBox[{"RotateLeft", "[", 
                    RowBox[{
                    RowBox[{"PadLeft", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"1", "+", 
                    RowBox[{
                    RowBox[{"\[Epsilon]", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"j", "+", "1"}]}], "]"}], "/", "2"}]}], " ", ",", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"\[Epsilon]", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"j", "+", "1"}], ",", "m"}], "]"}], "+", "1"}]}], 
                    "]"}]}], "/", "2"}]}], "}"}], " ", ",", "m"}], "]"}], ",", 
                    RowBox[{"m", "-", "2", "-", "j"}]}], "]"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", "0", ",", 
                   RowBox[{"m", "-", "1"}]}], "}"}]}], "]"}], "/.", 
               "epsilon"}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "The", " ", "program", " ", "creates", " ", "the", " ", 
               "matrix", " ", "g", " ", "that", " ", "identify", " ", "the", 
               " ", "wire", " ", 
               RowBox[{"resistances", "."}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"g", "=", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"2", "/", 
                    RowBox[{"\[Delta]", "[", "i", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"-", "2"}], "/", 
                    RowBox[{"\[Delta]", "[", "i", "]"}]}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], "/", 
                    RowBox[{"\[Delta]", "[", "i", "]"}]}], ",", 
                    RowBox[{"2", "/", 
                    RowBox[{"\[Delta]", "[", "i", "]"}]}]}], "}"}]}], "}"}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "1", ",", "l"}], "}"}]}], "]"}], "/.", 
               "delta"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{
               "The", " ", "program", " ", "creates", " ", "the", " ", "IAM", 
                " ", "\[ScriptCapitalY]", " ", "of", " ", "the", " ", "N", 
                " ", "QHE", " ", "elements"}], ",", " ", 
               RowBox[{
               "that", " ", "includes", " ", "the", " ", "terminal", " ", 
                "resistances"}], ",", " ", 
               RowBox[{"and", " ", "the", " ", "wire", " ", 
                RowBox[{"resistances", ".", " ", "This"}], " ", "is", " ", 
                "a", " ", "block", " ", "diagonal", " ", "matrix", " ", "and",
                 " ", "each", " ", "block", " ", "represents", " ", "an", " ",
                 "element", " ", "of", " ", "the", " ", 
                RowBox[{"QHARS", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"\[ScriptCapitalY]", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"DiagonalMatrix", "[", 
                 RowBox[{"Hold", "/@", 
                  RowBox[{"Join", "[", 
                   RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Inverse", "[", 
                    RowBox[{"\[ScriptCapitalD]", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], ".", 
                    RowBox[{"\[ScriptCapitalY]i", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
                    "g"}], "]"}]}], "]"}], "//", "ReleaseHold"}], "//", 
               "ArrayFlatten"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"\[ScriptCapitalY]n", " ", "=", 
              RowBox[{
              "\[ScriptCapitalA]T", ".", "\[ScriptCapitalY]", ".", 
               "\[ScriptCapitalA]"}]}], ";", " ", 
             RowBox[{"(*", 
              RowBox[{"Calculate", " ", "the", " ", "QHARS", " ", "IAM", " ", 
               RowBox[{"\[ScriptCapitalY]n", "."}]}], "*)"}], 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{
                RowBox[{"Evaluate", " ", "the", " ", "4"}], "-", 
                RowBox[{
                "terminal", " ", "resistance", " ", "corresponding", " ", 
                 "to", " ", "the", " ", "a"}]}], ",", 
               RowBox[{
               "b", " ", "voltage", " ", "nodes", " ", "and", " ", "c"}], ",", 
               RowBox[{"d", " ", "current", " ", "nodes"}], ",", " ", 
               RowBox[{
               "and", " ", "the", " ", "relative", " ", "deviation", " ", 
                "from", " ", "the", " ", "nominal", " ", 
                RowBox[{"value", "."}]}]}], "*)"}], 
             RowBox[{"rn", "=", 
              RowBox[{"rnSign", " ", 
               RowBox[{
                RowBox[{"Det", "[", 
                 RowBox[{"dropOperator", "[", 
                  RowBox[{"\[ScriptCapitalY]n", ",", 
                   RowBox[{"{", 
                    RowBox[{"c", ",", "d"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"a", ",", "b"}], "}"}]}], "]"}], "]"}], "/", 
                RowBox[{"Det", "[", 
                 RowBox[{"dropOperator", "[", 
                  RowBox[{"\[ScriptCapitalY]n", ",", 
                   RowBox[{"{", "1", "}"}], ",", 
                   RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}]}]}], ";", " ", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"rn", " ", 
               RowBox[{"N", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Denominator", "[", "rQn", "]"}], "/", 
                  RowBox[{"Numerator", "[", "rQn", "]"}]}], ",", "wp"}], 
                "]"}]}], "-", "1"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"h", ",", "s"}], "}"}]}], "]"}]}], ";"}], " ", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "The", " ", "procedure", " ", "is", " ", "repeated", " ", "S", " ", 
           "times", " ", 
           RowBox[{"(", 
            RowBox[{
            "S", " ", "is", " ", "the", " ", "sample", " ", "size", " ", "of",
              " ", "the", " ", "Monte", " ", "Carlo", " ", "analysis"}], 
            ")"}]}], ",", "   ", 
          RowBox[{
          "so", " ", "that", " ", "the", " ", "result", " ", "is", " ", "a", 
           " ", "list", " ", "of", " ", "the", " ", "S", " ", "relative", " ",
            "devitions", " ", 
           RowBox[{"obtained", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"meanResult", "=", 
       RowBox[{"Mean", "[", "result", "]"}]}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{
       "Mean", " ", "value", " ", "of", " ", "the", " ", "relative", " ", 
        "variation", " ", "distribution"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"stdDevResult", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"s", ">", "1"}], ",", 
         RowBox[{"StandardDeviation", "[", "result", "]"}], ",", "Infinity"}],
         "]"}]}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{
       "Standard", " ", "deviation", " ", "of", " ", "the", " ", 
        "distribution"}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"The", " ", "program", " ", "saves", " ", 
        RowBox[{"a", " ", ".", "wl"}], " ", 
        RowBox[{"file", " ", ".", "the"}], " ", "containig", " ", "the", " ", 
        "data", " ", 
        RowBox[{"obtained", ".", " ", "The"}], " ", "file", " ", "is", " ", 
        "saved", " ", "in", " ", "the", " ", "same", " ", "directory", " ", 
        "of", " ", "the", " ", "schematic", " ", "and", " ", "is", " ", 
        "named", " ", 
        RowBox[{
        "\"\<schematicName_data_YearMonthDayHourMinute.wl\>\"", ".", " ", 
         "It"}], " ", "can", " ", "be", " ", "recalled", " ", "with", " ", 
        "the", " ", "command", " ", 
        RowBox[{"Get", "[", 
         RowBox[{"file", " ", "name"}], "]"}], " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"or", " ", 
           RowBox[{"<<", " ", "file"}], " ", "name"}], ")"}], ".", " ", "A"}],
         " ", "copy", " ", "of", " ", "the", " ", "notebook", " ", "is", " ", 
        "saved", " ", "in", " ", "the", " ", "same", " ", "directory", " ", 
        "with", " ", "the", " ", "name", " ", "of", " ", "the", " ", 
        "schematic", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{".", "nb"}], ")"}], "."}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Save", "[", 
       RowBox[{
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"FileNameDrop", "[", "file", "]"}], ",", 
           RowBox[{
            RowBox[{"FileBaseName", "[", "file", "]"}], "<>", 
            "\"\<_data_\>\"", "<>", 
            RowBox[{"DateString", "[", 
             RowBox[{"{", 
              RowBox[{
              "\"\<Year\>\"", ",", "\"\<Month\>\"", ",", "\"\<Day\>\"", ",", 
               "\"\<T\>\"", ",", "\"\<Hour\>\"", ",", "\"\<Minute\>\""}], 
              "}"}], "]"}], "<>", "\"\<.wl\>\""}]}], "}"}], "]"}], ",", 
        "\"\<Global`\>\""}], "]"}], ";", 
      RowBox[{"NotebookSave", "[", 
       RowBox[{
        RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"FileNameDrop", "[", "file", "]"}], ",", 
           RowBox[{
            RowBox[{"FileBaseName", "[", "file", "]"}], "<>", 
            RowBox[{"DateString", "[", 
             RowBox[{"{", 
              RowBox[{
              "\"\<Year\>\"", ",", "\"\<Month\>\"", ",", "\"\<Day\>\"", ",", 
               "\"\<T\>\"", ",", "\"\<Hour\>\"", ",", "\"\<Minute\>\""}], 
              "}"}], "]"}], "<>", "\"\<.nb\>\""}]}], "}"}], "]"}]}], "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "The", " ", "distribution", " ", "is", " ", "plotted", " ", "as", " ", 
        "an", " ", 
        RowBox[{"histogram", ".", " ", "It"}], " ", "is", " ", "exported", 
        " ", "in", " ", "the", " ", "same", " ", "directory", " ", "of", " ", 
        "the", " ", "circuit", " ", 
        RowBox[{"schematic", "."}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"MantExpMean", "=", 
       RowBox[{"MantissaExponent", "[", "meanResult", "]"}]}], ";", 
      RowBox[{"MantExpResult", "=", 
       RowBox[{"MantissaExponent", "[", "result", "]"}]}], ";", 
      RowBox[{"ExpMean", "=", 
       RowBox[{
        RowBox[{"MantExpMean", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "-", "1"}]}], ";", 
      RowBox[{"MantResult", "=", 
       RowBox[{"result", "*", 
        RowBox[{"10", "^", 
         RowBox[{"(", 
          RowBox[{"-", "ExpMean"}], ")"}]}]}]}], ";", 
      RowBox[{"h", "=", 
       RowBox[{"Labeled", "[", 
        RowBox[{
         RowBox[{"Histogram", "[", 
          RowBox[{"MantResult", ",", 
           RowBox[{"ChartStyle", "\[Rule]", "Blue"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
            "StringTemplate", "[", 
             "\"\<\[Times] \!\(\*SuperscriptBox[\(10\), \(`a`\)]\) \
\!\(\*SubscriptBox[SuperscriptBox[\(\[CapitalDelta]R\), \(Q\)], \(ab, cd\)]\)\
\>\"", "]"}], "[", 
            RowBox[{"<|", 
             RowBox[{"\"\<a\>\"", "->", 
              RowBox[{"-", "ExpMean"}]}], "|>"}], "]"}], ",", 
           "\"\<counts\>\""}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Bottom", ",", "Left"}], "}"}], ",", 
         RowBox[{"RotateLabel", "\[Rule]", "True"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"FileNameDrop", "[", "file", "]"}], ",", 
           RowBox[{
            RowBox[{"FileBaseName", "[", "file", "]"}], "<>", 
            RowBox[{"DateString", "[", 
             RowBox[{"{", 
              RowBox[{
              "\"\<Year\>\"", ",", "\"\<Month\>\"", ",", "\"\<Day\>\"", ",", 
               "\"\<T\>\"", ",", "\"\<Hour\>\"", ",", "\"\<Minute\>\""}], 
              "}"}], "]"}], "<>", "\"\<_plot.png\>\""}]}], "}"}], "]"}], ",", 
        "h", ",", 
        RowBox[{"ImageResolution", "\[Rule]", "600"}]}], "]"}], ";", 
      RowBox[{"Print", "[", "h", "]"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "180"}], ",", 
     RowBox[{"Background", "\[Rule]", "Red"}], ",", 
     RowBox[{"BaseStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"14", ",", "White", ",", "Bold"}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Method", "\[Rule]", "\"\<Queued\>\""}]}], "]"}]}], 
  "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.697791028309944*^9, 3.697791069957163*^9}, {
   3.69779111686099*^9, 3.697791268318499*^9}, {3.697791308590459*^9, 
   3.6977913197101383`*^9}, {3.697791382600986*^9, 3.6977914358463793`*^9}, {
   3.6977914976092567`*^9, 3.697791524886715*^9}, {3.697791655383559*^9, 
   3.697791655546288*^9}, {3.697791703919471*^9, 3.6977917343906*^9}, {
   3.6977917986148567`*^9, 3.697791848982562*^9}, 3.6977918880634413`*^9, {
   3.697791952447309*^9, 3.6977919681760902`*^9}, {3.6977920423484793`*^9, 
   3.6977922239493933`*^9}, {3.697792289235209*^9, 3.6977923857906923`*^9}, {
   3.6977925222081633`*^9, 3.6977925509453077`*^9}, 3.697792689153211*^9, {
   3.697792837405758*^9, 3.697792839924996*^9}, 3.697792974201353*^9, {
   3.697793010600594*^9, 3.697793022175585*^9}, {3.697793105888468*^9, 
   3.697793132967244*^9}, {3.6977931777601013`*^9, 3.697793213670615*^9}, {
   3.697793460130806*^9, 3.697793513831108*^9}, 3.6977938970818167`*^9, 
   3.697793941130003*^9, 3.6977941111989117`*^9, {3.6977941915125103`*^9, 
   3.697794201735846*^9}, 3.6978037654523077`*^9, {3.6978039205874863`*^9, 
   3.697803922097596*^9}, {3.697804046451006*^9, 3.697804052650947*^9}, {
   3.6978041180271597`*^9, 3.697804154906459*^9}, 3.6978043596661243`*^9, {
   3.697804550515667*^9, 3.697804595378907*^9}, {3.697804691171927*^9, 
   3.6978047234344997`*^9}, {3.69780477617135*^9, 3.697804777274884*^9}, {
   3.697804819707261*^9, 3.697804820113525*^9}, 3.69787070973357*^9, {
   3.697870884494351*^9, 3.697870902832052*^9}, 3.697871008707533*^9, {
   3.697871073502891*^9, 3.6978710773815002`*^9}, {3.697871160321075*^9, 
   3.697871169703836*^9}, {3.6978712394437523`*^9, 3.69787128892875*^9}, {
   3.697871344967155*^9, 3.697871354228421*^9}, {3.697874138880577*^9, 
   3.697874151311266*^9}, {3.697875418287568*^9, 3.697875426269649*^9}, {
   3.6978891146312*^9, 3.697889130011101*^9}, {3.6978891972696*^9, 
   3.697889209529286*^9}, {3.697974054689623*^9, 3.697974069610359*^9}, {
   3.698063309619266*^9, 3.698063311553529*^9}, {3.698063376057516*^9, 
   3.6980633766812897`*^9}, {3.702292508704855*^9, 3.702292533585311*^9}, {
   3.703500658785389*^9, 3.703500727219895*^9}, {3.7035008278760357`*^9, 
   3.7035008285295415`*^9}, {3.7035010761213894`*^9, 3.7035011658543606`*^9}, 
   3.7041890683967905`*^9, {3.704189351361411*^9, 3.704189380020511*^9}, {
   3.7041896119427567`*^9, 3.7041896480542383`*^9}, {3.704191789265735*^9, 
   3.704191792702942*^9}, {3.70419262077087*^9, 3.7041926237317605`*^9}, {
   3.7041933890879555`*^9, 3.704193393075449*^9}, {3.704195845922211*^9, 
   3.704195856659675*^9}, {3.704626809124688*^9, 3.704626842759739*^9}, {
   3.7046269179311085`*^9, 3.7046269198271112`*^9}, {3.7046269946203814`*^9, 
   3.7046270168091583`*^9}, {3.704709265435097*^9, 3.704709272903075*^9}, {
   3.704709484112871*^9, 3.704709501886287*^9}, {3.7047095365438695`*^9, 
   3.7047095993978324`*^9}, {3.7047097423982754`*^9, 3.704709761667358*^9}, {
   3.704709815815931*^9, 3.7047098370359983`*^9}, {3.7047098697710276`*^9, 
   3.7047098930865216`*^9}, {3.704709940284252*^9, 3.7047099719775906`*^9}, {
   3.7047100524415045`*^9, 3.7047100571018333`*^9}, {3.704710184408619*^9, 
   3.704710273834527*^9}, {3.7047107500509744`*^9, 3.7047107605240993`*^9}, {
   3.7047107910383415`*^9, 3.7047108008869534`*^9}, {3.704710862886529*^9, 
   3.7047108685827923`*^9}, {3.7047109426764865`*^9, 3.7047109603625183`*^9}, 
   3.7047110675405912`*^9, {3.70471117826604*^9, 3.7047112334027257`*^9}, {
   3.7047113471794925`*^9, 3.7047113852528677`*^9}, {3.7047114520372*^9, 
   3.704711568568062*^9}, {3.704711609873876*^9, 3.7047116318913636`*^9}, {
   3.704713990091264*^9, 3.7047140738800583`*^9}, 3.7047141365508795`*^9, {
   3.704714259915577*^9, 3.7047143568108373`*^9}, 3.7047144114797297`*^9, {
   3.7047145695849977`*^9, 3.70471457965491*^9}, 3.704714611969738*^9, {
   3.7047147651579294`*^9, 3.704714789408347*^9}, {3.7047150834431624`*^9, 
   3.704715084906732*^9}, {3.704775702254896*^9, 3.7047757571705284`*^9}, {
   3.7047758805736446`*^9, 3.704775903143533*^9}, {3.7047770174745073`*^9, 
   3.704777051713153*^9}, {3.7047773168199186`*^9, 3.7047773196812944`*^9}, {
   3.704777427180114*^9, 3.7047774279795923`*^9}, {3.70480027871624*^9, 
   3.7048002897370057`*^9}, {3.7048003246437874`*^9, 
   3.7048003273652043`*^9}, {3.705122314208873*^9, 3.705122320995164*^9}, 
   3.7051304473289647`*^9, 3.705130803787737*^9, {3.705130864112204*^9, 
   3.7051308730898514`*^9}, {3.7051309101704144`*^9, 
   3.7051309147899103`*^9}, {3.705131004348622*^9, 3.7051310101424184`*^9}, {
   3.705144813327464*^9, 3.7051449455566144`*^9}, {3.7051459076367655`*^9, 
   3.705145910286883*^9}, {3.7051459475372825`*^9, 3.705145948422743*^9}, {
   3.718454357830027*^9, 3.718454378467276*^9}, {3.71845441778837*^9, 
   3.71845442301192*^9}, {3.718454464548497*^9, 3.718454464643612*^9}, {
   3.7184550211727247`*^9, 3.71845503980396*^9}, {3.718455659877963*^9, 
   3.71845566511762*^9}, {3.718689696612896*^9, 3.718689715687265*^9}, {
   3.718689973292472*^9, 3.7186900223395853`*^9}, 3.7186934968378143`*^9, 
   3.718707846381011*^9, {3.7192311162486134`*^9, 3.7192311570174236`*^9}, 
   3.7192312986673417`*^9, {3.719231336528469*^9, 3.719231349460777*^9}, {
   3.719231429493989*^9, 3.719231618731649*^9}, {3.7192316502337437`*^9, 
   3.7192317282990294`*^9}, {3.7192318074927254`*^9, 
   3.7192319517390137`*^9}, {3.719231994004512*^9, 3.7192319960691633`*^9}, {
   3.7192320324650145`*^9, 3.7192323142420793`*^9}, {3.719232354456664*^9, 
   3.7192325606975746`*^9}, {3.719923523379553*^9, 3.719923743021985*^9}, {
   3.7199237769309397`*^9, 3.719923848605073*^9}, {3.719923881179485*^9, 
   3.7199239861629815`*^9}, {3.71992402384708*^9, 3.7199240734860773`*^9}, {
   3.7199241195796676`*^9, 3.7199242026736064`*^9}, {3.7199242576237264`*^9, 
   3.7199242621106586`*^9}, {3.719924307127364*^9, 3.719924308072879*^9}, {
   3.719924345676873*^9, 3.7199243551049457`*^9}, {3.72016071921966*^9, 
   3.720160743325461*^9}, {3.720160918166629*^9, 3.720160919270237*^9}, {
   3.7201609890540524`*^9, 3.720161045895368*^9}},
 FontSize->14,
 FontWeight->"Bold",ExpressionUUID->"76982c03-5ad5-43af-a7f9-78d77ddd5ff6"],

Cell[BoxData[
 ButtonBox["\<\"Run the QHARS machine\"\>",
  Appearance->Automatic,
  Background->RGBColor[1, 0, 0],
  BaseStyle->{14, 
    GrayLevel[1], Bold},
  ButtonFunction:>($CellContext`\[Tau] = 
    Timing[$CellContext`result = Table[$CellContext`epsilonRandom$1096 = Table[
            RandomReal[{
              Part[$CellContext`epsilonLim, $CellContext`v, 1], 
              Part[$CellContext`epsilonLim, $CellContext`v, 2]}, 
             WorkingPrecision -> $CellContext`wp], {$CellContext`v, \
$CellContext`n $CellContext`m}]; $CellContext`deltaRandom$1096 = Table[
            RandomReal[{
              Part[$CellContext`deltaLim, $CellContext`w, 1], 
              Part[$CellContext`deltaLim, $CellContext`w, 2]}, 
             WorkingPrecision -> $CellContext`wp], {$CellContext`w, \
$CellContext`l}]; $CellContext`epsilon = Flatten[
            
            Table[$CellContext`\[Epsilon]$1096[$CellContext`j, \
$CellContext`k] -> 
             Part[$CellContext`epsilonRandom$1096, ($CellContext`j - 
                 1) $CellContext`m + $CellContext`k], {$CellContext`j, \
$CellContext`n}, {$CellContext`k, $CellContext`m}]]; $CellContext`delta = 
          Table[$CellContext`\[Delta]$1096[$CellContext`w] -> 
            Part[$CellContext`deltaRandom$1096, $CellContext`w], \
{$CellContext`w, $CellContext`l}]; $CellContext`\[ScriptCapitalD] = ReplaceAll[
            Table[
             If[Part[$CellContext`qheType, $CellContext`i] == 0, 
              RotateLeft[
               
               PadLeft[{(-$CellContext`\[Epsilon]$1096[$CellContext`i, 
                    Mod[$CellContext`j - 1, $CellContext`m] + 1])/2, 
                 1 + $CellContext`\[Epsilon]$1096[$CellContext`i, \
$CellContext`j + 1]/2}, $CellContext`m], $CellContext`m - 1 - $CellContext`j], 
              RotateLeft[
               
               PadLeft[{
                1 + $CellContext`\[Epsilon]$1096[$CellContext`i, \
$CellContext`j + 1]/
                  2, (-$CellContext`\[Epsilon]$1096[$CellContext`i, 
                    Mod[$CellContext`j + 1, $CellContext`m] + 1])/
                 2}, $CellContext`m], $CellContext`m - 
               2 - $CellContext`j]], {$CellContext`i, 
              1, $CellContext`n}, {$CellContext`j, 0, $CellContext`m - 
              1}], $CellContext`epsilon]; $CellContext`g = ReplaceAll[
            
            Table[{{2/$CellContext`\[Delta]$1096[$CellContext`i], \
(-2)/$CellContext`\[Delta]$1096[$CellContext`i]}, \
{(-2)/$CellContext`\[Delta]$1096[$CellContext`i], 
               2/$CellContext`\[Delta]$1096[$CellContext`i]}}, \
{$CellContext`i, 
              1, $CellContext`l}], $CellContext`delta]; $CellContext`\
\[ScriptCapitalY] = ArrayFlatten[
            ReleaseHold[
             DiagonalMatrix[
              Map[Hold, 
               Join[
                Table[
                 Dot[
                  Inverse[
                   Part[$CellContext`\[ScriptCapitalD], $CellContext`i]], 
                  
                  Part[$CellContext`\[ScriptCapitalY]i, $CellContext`i]], \
{$CellContext`i, 
                  1, $CellContext`n}], $CellContext`g]]]]]; $CellContext`\
\[ScriptCapitalY]n = 
          Dot[$CellContext`\[ScriptCapitalA]T, \
$CellContext`\[ScriptCapitalY], $CellContext`\[ScriptCapitalA]]; \
$CellContext`rn = $CellContext`rnSign (Det[
              $CellContext`dropOperator[$CellContext`\[ScriptCapitalY]n, \
{$CellContext`c, $CellContext`d}, {$CellContext`a, $CellContext`b}]]/Det[
             $CellContext`dropOperator[$CellContext`\[ScriptCapitalY]n, {1}, {
              1}]]); $CellContext`err = $CellContext`rn 
            N[Denominator[$CellContext`rQn]/
              Numerator[$CellContext`rQn], $CellContext`wp] - 
           1, {$CellContext`h, $CellContext`s}]; Null]; $CellContext`mean = 
    Mean[$CellContext`result]; $CellContext`standDev = If[$CellContext`s > 1, 
      StandardDeviation[$CellContext`result], Infinity]; Save[
     FileNameJoin[{
       FileNameDrop[$CellContext`file], 
       StringJoin[
        FileBaseName[$CellContext`file], "_data_", 
        DateString[{"Year", "Month", "Day", "T", "Hour", "Minute"}], ".wl"]}],
      "Global`"]; NotebookSave[
     EvaluationNotebook[], 
     FileNameJoin[{
       FileNameDrop[$CellContext`file], 
       StringJoin[
        FileBaseName[$CellContext`file], 
        DateString[{"Year", "Month", "Day", "T", "Hour", "Minute"}], 
        ".nb"]}]]; 
   SendMail["To" -> "martina.marzano@polito.it", "Subject" -> "QHARS", "Body" -> 
     TemplateApply[
      "Ciao, mi chiamo Mathematica e sono una deficienza artificiale. Ho \
preso possesso del computer di Massimo e sto spedendo email idiote a caso. \
Tanto pare che nessuno noti la differenza. \n\nThe simulation is terminated. \
\n\nSample Size=`s` \n\nWorking Precision=`wp` \n\nMean=`mean` \n\n\
StandardDeviation=`stDev` \n\nTime=`time` \n\nArvedze,\nMathematica", {
        Association[
        "mean" -> ScientificForm[$CellContext`mean], "stDev" -> 
         ScientificForm[$CellContext`standDev], "time" -> 
         Part[$CellContext`\[Tau], 1], "wp" -> $CellContext`wp, 
         "s" -> $CellContext`s]}]]; $CellContext`MantExpMean = 
    MantissaExponent[$CellContext`mean]; $CellContext`MantExpResult = 
    MantissaExponent[$CellContext`result]; $CellContext`ExpMean = 
    Part[$CellContext`MantExpMean, 2] - 
     1; $CellContext`MantResult = $CellContext`result 
     10^(-$CellContext`ExpMean); $CellContext`h = Labeled[
      Histogram[$CellContext`MantResult, ChartStyle -> Blue], {
       StringTemplate[
       "\[Times] \!\(\*SuperscriptBox[\(10\), \(`a`\)]\) \
\!\(\*SubscriptBox[SuperscriptBox[\(\[CapitalDelta]R\), \(Q\)], \(ab, \
cd\)]\)"][
        Association["a" -> -$CellContext`ExpMean]], "counts"}, {Bottom, Left},
       RotateLabel -> True]; Export[
     FileNameJoin[{
       FileNameDrop[$CellContext`file], 
       StringJoin[
        FileBaseName[$CellContext`file], "_plot.png"]}], $CellContext`h, 
     ImageResolution -> 600]; Print[$CellContext`h]),
  Evaluator->Automatic,
  ImageSize->180,
  Method->"Queued"]], "Output",
 CellChangeTimes->{3.718693590348033*^9, 3.7186960924770937`*^9, 
  3.718698174729907*^9, 3.718709575804171*^9},
 ExpressionUUID -> "d8e610f3-40ed-4e5c-8417-da76021b8ab3"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\\n", "\\n", "Sample", " ", "Size"}], "=", 
   RowBox[{
    RowBox[{"`s`", " ", "\\n", "\\n", "Working", " ", "Precision"}], "=", 
    RowBox[{
     RowBox[{"`wp`", " ", "\\n", "\\n", "Mean"}], "=", 
     RowBox[{
      RowBox[{"`mean`", " ", "\\n", "\\n", "StandardDeviation"}], "=", 
      RowBox[{
       RowBox[{"`stDev`", " ", "\\n", "\\n", "Time"}], "=", 
       RowBox[{"`time`", " ", "\\n", "\\n", "Arvedze"}]}]}]}]}]}], ",", 
  RowBox[{"\\n", "Mathematica", "\"\<\>"}]}]], "Input",ExpressionUUID->\
"24e0d27a-33ad-445d-857c-8dad841ad2f6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"<|", 
      RowBox[{
       RowBox[{"\"\<mean\>\"", "\[Rule]", 
        RowBox[{"ScientificForm", "[", "mean", "]"}]}], ",", 
       RowBox[{"\"\<stDev\>\"", "\[Rule]", 
        RowBox[{"ScientificForm", "[", "standDev", " ", "]"}]}], ",", 
       RowBox[{"\"\<time\>\"", "\[Rule]", 
        RowBox[{"\[Tau]", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{"\"\<wp\>\"", "\[Rule]", "wp"}], ",", 
       RowBox[{"\"\<s\>\"", "\[Rule]", "s"}]}], "|>"}], "}"}], "]"}], "]"}], 
  ";"}]], "Input",ExpressionUUID->"4ea5ba48-e732-4ae6-b54c-abe99be336b1"]
},
WindowSize->{1280, 941},
WindowMargins->{{1, Automatic}, {Automatic, 25}},
Magnification:>1.15 Inherited,
FrontEndVersion->"11.1 for Linux x86 (64-bit) (April 18, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 3805, 79, 357, "Input", "ExpressionUUID" -> \
"98b26e2b-3c6f-4a71-8c17-aec7d93c8c72"],
Cell[4366, 101, 5249, 125, 376, "Input", "ExpressionUUID" -> \
"5d01b7c7-7ee1-4903-86e7-d078ce7e291f",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[9640, 230, 29963, 532, 1499, "Input", "ExpressionUUID" -> \
"9db3d987-d955-430a-8827-87ac78131ff8",
 InitializationCell->True],
Cell[39606, 764, 7559, 147, 78, "Output", "ExpressionUUID" -> \
"93ea5d85-48a9-4864-b84e-715d587ab160"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47202, 916, 9228, 196, 600, "Input", "ExpressionUUID" -> \
"96d91682-abe4-4c44-8616-430c9bd1f76d",
 InitializationCell->True],
Cell[56433, 1114, 2792, 53, 105, "Output", "ExpressionUUID" -> \
"7b9eb8d9-a55c-439f-b3ff-41255a0345e5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59262, 1172, 25424, 515, 1403, "Input", "ExpressionUUID" -> \
"76982c03-5ad5-43af-a7f9-78d77ddd5ff6",
 InitializationCell->True],
Cell[84689, 1689, 6263, 126, 78, "Output", "ExpressionUUID" -> \
"d8e610f3-40ed-4e5c-8417-da76021b8ab3"]
}, Open  ]],
Cell[90967, 1818, 594, 14, 39, "Input", "ExpressionUUID" -> \
"24e0d27a-33ad-445d-857c-8dad841ad2f6"],
Cell[91564, 1834, 649, 16, 39, "Input", "ExpressionUUID" -> \
"4ea5ba48-e732-4ae6-b54c-abe99be336b1"]
}
]
*)

